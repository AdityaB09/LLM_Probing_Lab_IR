{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-semibold mb-2">Results for Run #{{ run.id }}</h1>
<p class="text-slate-400 mb-4">
  {{ run.dataset_name }} • {{ run.sample_size }} samples • Models:
  {{ run.models }}
</p>

{% if run.summary %}
<div class="bg-slate-900/70 border border-cyan-500/40 rounded-2xl p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2 text-cyan-300">Auto Summary</h2>
  <div class="prose prose-invert text-sm max-w-none">
    {{ run.summary | safe | replace('\n', '<br>') | safe }}
  </div>
</div>
{% endif %}

<div class="grid md:grid-cols-2 gap-6">
  <div class="panel">
    <h3 class="panel-title">Accuracy vs Layer</h3>
    <canvas id="accChart"></canvas>
  </div>
  <div class="panel">
    <h3 class="panel-title">Weighted F1 vs Layer</h3>
    <canvas id="f1Chart"></canvas>
  </div>
  <div class="panel">
    <h3 class="panel-title">ECE vs Layer</h3>
    <canvas id="eceChart"></canvas>
  </div>
</div>

<script>
  window.addEventListener("load", () => {
    fetch("{{ url_for('api_run_metrics', run_id=run.id) }}")
      .then((r) => r.json())
      .then((metrics) => renderRunCharts(metrics));
  });
</script>
{% endblock %}
